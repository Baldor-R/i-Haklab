#!/data/data/com.termux/files/usr/bin/sh

SCRIPT_NAME=$(basename "$1")
BEEF_PATH="/data/data/com.termux/files/usr/opt/beef"
BACK=$(pwd)

if [ -d $HOME/i-Haklab ]; then
	TMP_PATH="$HOME"
elif [ -d $HOME/storage/external-1/roothome/i-Haklab ]; then
	TMP_PATH="$HOME/storage/external-1/roothome"
else
	echo "$R\n[w]-> i-Haklab directory undefined <-[w]$W\n"
	exit
fi
STDERR() {
	echo "$R\n[w] i-Haklab :$W $SCRIPT_NAME is not installed$W\n"
	exit
}
# Fix ruby bigdecimal extensions linking error.
case "$(uname -m)" in
	aarch64)
		export LD_PRELOAD="$LD_PRELOAD:/data/data/com.termux/files/usr/lib/ruby/2.6.0/aarch64-linux-android/bigdecimal.so"
		;;
	arm*)
		export LD_PRELOAD="$LD_PRELOAD:/data/data/com.termux/files/usr/lib/ruby/2.6.0/arm-linux-androideabi/bigdecimal.so"
		;;
	i686)
		export LD_PRELOAD="$LD_PRELOAD:/data/data/com.termux/files/usr/lib/ruby/2.6.0/i686-linux-android/bigdecimal.so"
		;;
	x86_64)
		export LD_PRELOAD="$LD_PRELOAD:/data/data/com.termux/files/usr/lib/ruby/2.6.0/x86_64-linux-android/bigdecimal.so"
		;;
	*)
		;;
esac

case "$SCRIPT_NAME" in
	beef|beef-xss)
		if [ -d $BEEF_PATH ]; then
			cd $BEEF_PATH
			exec ruby "$BEEF_PATH/$SCRIPT_NAME" "$@"
			cd $BACK
		else
			STDERR
		fi
		;;
	wpscan)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
			cd $TMP_PATH/$SCRIPT_NAME/bin
			exec ruby "$TMP_PATH/$SCRIPT_NAME/bin/$SCRIPT_NAME" "$@"
			cd $BACK
		else
			STDERR
		fi
		;;
	androbugs)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
			cd $TMP_PATH/$SCRIPT_NAME
			exec python2 "$TMP_PATH/$SCRIPT_NAME/$SCRIPT_NAME.py" "$@"
			cd $BACK
		else
			STDERR
		fi
		;;
	d-tect)
		if [ -d $TMP_PATH/D-TECT-1 ]; then
                        cd $TMP_PATH/D-TECT-1
                        exec python2 "$TMP_PATH/D-TECT-1/$SCRIPT_NAME.py" "$@"
                        cd $BACK
                else
                        STDERR
		fi
		;;
	adminpanel)
		if [ -d $TMP_PATH/admin_panel ]; then
                        cd $TMP_PATH/admin_panel
                        exec python2 "$TMP_PATH/admin_panel/admin_panel.py" "$@"
                        cd $BACK
                else
                        STDERR
                fi
		;;
	cc-genpro)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/$SCRIPT_NAME
                        exec python2 "$TMP_PATH/$SCRIPT_NAME/cc-genpro1.2.py" "$@"
                        cd $BACK
                else
                        STDERR
		fi
		;;
	credmap)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/$SCRIPT_NAME
                        exec python2 "$TMP_PATH/$SCRIPT_NAME/$SCRIPT_NAME.py" "$@"
                        cd $BACK
                else
			STDERR
		fi
		;;
	evilurl)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/$SCRIPT_NAME
                        exec python "$TMP_PATH/$SCRIPT_NAME/$SCRIPT_NAME.py" "$@"
                        cd $BACK
                else
                        STDERR
		fi
		;;
	exploitdb)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/$SCRIPT_NAME
                        exec bash "$TMP_PATH/$SCRIPT_NAME/searchsploit" "$@"
                        cd $BACK
                else
                        STDERR
		fi
		;;
	fbbrute)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/$SCRIPT_NAME
                        exec python2 "$TMP_PATH/$SCRIPT_NAME/$SCRIPT_NAME.py" "$@"
                        cd $BACK
                else
                        STDERR
		fi
		;;
	fbi)
		if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/$SCRIPT_NAME
                        exec python2 "$TMP_PATH/$SCRIPT_NAME/$SCRIPT_NAME.py" "$@"
                        cd $BACK
                else
                        STDERR
		fi
		;;
	phoneinfoga)
                if [ -d $TMP_PATH/$SCRIPT_NAME ]; then
                        cd $TMP_PATH/PhoneInfoga
                        exec python "$TMP_PATH/PhoneInfoga/$SCRIPT_NAME.py" "$@"
                        cd $BACK
                else
			STDERR
		fi
                ;;
	*)
		echo "$R\n[w] i-Haklab :$W Unknown argument '$SCRIPT_NAME'\n"
		exit 1
		;;
esac
