#!/data/data/com.termux/files/usr/bin/bash
#This script will install i-Haklab v.1.0 2019 by Ivam3 - It is a hacking laboratory that contains open source tools recommended by Ivam3. Please do not use in military or secret service organizations, or for illegal purposes.
IFS=$'\n\t'
trap ctrl_c 2
function ctrl_c() {
	echo
	printf "$Y\n\n[!]$R Going me on$B Telegram$R t.me/Ivam3byCinderella$W\n\n"
}
while [ $USER = "root" ]; do
        printf "$R\n[W]:-> You need to be a common user to install i-Haklab$W\n"
        exit
done
echo $(clear)
        printf "$C"
                echo "            -{> i-Haklab <} "
                echo "   -{ SO > Android - Only for Termux } "
                echo "             -{ Coded by } "
                printf "$G"
                echo "      =============================="
                echo "      .___.                 ______,"
                echo "      |   |__ ______   ___  \_____ \ "
                echo "      |   \ \/ /\__ \ /   \   _(__ <,"
                echo "      |   |\   / __ \| Y Y \ /      \ "
                echo "      |___| \_/ (____|__|_| /______ /"
                echo "                     \/    \/      \/ "
                echo "      ====== By ___ Cinderella ======"
        printf "$C\n"
                echo "          [---] Join me on [---]"
                echo "[-] www.youtube.com/c/ivam3bycinderella [-]"
                echo "      [-] t.me/Ivam3byCinderella [-]"
                echo "            [-] t.me/ivam3 [-]"
        printf "$G\n"
                echo "        [---] SPECIAL THANKS [---]"
        	echo "                    TO "
		echo "       [-] MY MASTER CINDERELLA [-]"
	printf "$W"
        	echo "             People don't die"
        	echo "    If they still live in the hearts"
        	echo "           of their loved ones"
        	echo "       We love her ... We miss her"
        	echo "                   *RIP*"
        printf "$R\n"
                echo "          [---] DISCLAIMER [---]"
        printf "$W"
                echo "   If the law is violated with it's use"
                echo "     This would be the responsibility"
                echo "        of the user who handled it"
        printf "$R"
                echo "       [-] Use At Your Own Risk [-]"
        printf "$W\n"
        printf "$C         Press$G ENTER$C to continue"
        printf "$W\n"
        read enter
if [ -e $PREFIX/libexec/colors ]; then
        rm $PREFIX/libexec/colors
fi
wget https://raw.githubusercontent.com/ivam3/i-Haklab/master/.set/libexec/colors -O $PREFIX/libexec/colors
wget https://raw.githubusercontent.com/ivam3/i-Haklab/master/.set/var/alias -O $PREFIX/var/alias
source $PREFIX/libexec/colors
CHECKROOT=$(bash $iHAKLAB/.set/to-install/check-root)
USR=$(whoami)
if [ $CHECKROOT = "root" ]; then
	command -v sudo > /dev/null || bash $iHAKLAB/.set/to-install/instasudo
        if [ -e ~/.suroot/.bashrc ]; then
                if [ ! -O ~/.suroot/.bashrc ]; then
			command -v sudo > /dev/null || printf "$R[W]->$W sudo command cannot be installed\n"; exit
                                sudo chown $USR:$USR ~/.suroot/.bashrc
                fi
        fi
        echo "PS1="\[\e[33m\][!] \[\e[31m\]Type\[\e[32m\] exit\[\e[31m\] to log out\[\e[32m\] âž¤ \[\e[m\]"" > ~/.suroot/.bashrc
        echo "export TERM=xterm-256color" >> ~/.suroot/.bashrc
        echo "export LD_LIBRARY_PATH=/data/data/com.termux/files/usr/lib" >> ~/.suroot/.bashrc
        echo "export PATH=/data/data/com.termux/files/usr/bin:/data/data/com.termux/files/usr/bin/applets:/system/xbin:/system/bin" >> ~/.suroot/.bashrc
        echo "HOME=/data/data/com.termux/files/home/storage/external-1/roothome" >> ~/.suroot/.bashrc
	echo "fish" >> ~/.suroot/.bashrc
        echo "#          i-Haklab by @Ivam3" >> ~/.suroot/.bashrc
        echo "alias server-php="sudo php -S LOCALHOST:80 -t $PREFIX/var/service/php/"" >> $PREFIX/var/alias
else
        sed -i "3a alias server-php="php -S LOCALHOST:4546 -t $PREFIX/var/service/php/"" $PREFIX/var/alias
fi
if [ -d ~/storage ];then
	rm -rf ~/storage
fi
termux-setup-storage
if [ -L ~/storage/external-1 ] && [ ! -d /data/sdext2/data/com.termux ]; then #i-HAKLAB IN EXTERNAL DIRECTORY
	until [ -d ~/storage/external-1/roothome ]; do
		printf "$R\n[W]-> O-ops!!$W roothome directory cannot be created\n"
		mkdir -p ~/storage/external-1/roothome
	done
	until [ -O ~/storage/external-1/roothome ]; do
		printf "$R\n[W]-> O-ops!!$W Your are not owner of roothome directory\n"
		sudo chown $USR:$USR ~/storage/external-1/roothome
	done
	mv ~/i-Haklab ~/storage/external-1/roothome/
	iHAKLAB=/data/data/com.termux/files/home/storage/external-1/roothome/i-Haklab
elif [ -d /data/sdext2/data/com.termux ] || [ -d /data/data/com.termux ]; then #i-HAKLAB IN INTERNAL DIRECTORY
	if [ -d ~/storage ]; then
		rm -rf ~/storage
	fi
	iHAKLAB=/data/data/com.termux/files/home/i-Haklab
else
	printf "$R\n[W]-> i-Haklab repository have to be in home directory$W\n"
fi
apt autoremove;apt update && apt upgrade;apt install fish root-repo util-linux coreutils vim python python2 ruby ruby-dev perl clang curl wget make openssl openssl-tool php zip unzip tar w3m neofetch dirmngr weechat irssi tor htop bison megatools findutils git apr apr-util libffi-dev libgmp-dev postgresql-dev readline-dev libsqlite-dev openssh openssl-dev libtool libxml2-dev libxslt-dev ncurses-dev pkg-config libgrpc-dev termux-tools ncurses-utils ncurses postgresql termux-elf-cleaner libcaca fortune figlet man termux-api hydra megatools axel apksigner aircrack-ng ethtool macchanger -y

SRCH=$(ls $iHAKLAB/.set/to-install/ | grep -iv .zip | grep -iv instasudo | grep -iv checkroot | grep -iv i-haklab_login | grep -iv login | grep -iv functions | grep -iv QG)

for TOOL in $SRCH; do
        printf "$Y\n[!]->$G Installing $TOOL"
        bash $iHAKLAB/.set/to-install/$TOOL
	printf "\n\n"
done
wget https://raw.githubusercontent.com/ivam3/i-Haklab/master/.set/bin/i-Haklab -O $PREFIX/bin/i-Haklab #Command i-Haklab
curl -L http://get.oh-my.fish | fish
echo "source $PREFIX/var/alias" >> $PREFIX/etc/fish/config.fish
bash $iHAKLAB/.set/to-install/functions
bash $iHAKLAB/.set/to-install/i-Haklab_login
for del in bin functions login-files sqliv var ; do
	rm -rf $iHAKLAB/.set/$del
done
if [ -e ~/ivam3-Haklab ]; then
	rm ~/ivam3-Haklab
fi
#			echo $(set fish_greeting) #UNSET FISH GREETING
